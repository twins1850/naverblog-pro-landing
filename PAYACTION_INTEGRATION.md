# PayAction í†µí•© ê°€ì´ë“œ - ì™„ë²½ ë¬¸ì„œ

> PayAction ê°œë°œì ì„¼í„°ì˜ ëª¨ë“  ë‚´ìš©ì„ ì²´ê³„ì ìœ¼ë¡œ ì •ë¦¬í•œ í†µí•© ë¬¸ì„œì…ë‹ˆë‹¤.

## ğŸ“š ëª©ì°¨

1. [ì—°ë™ ê°€ì´ë“œ](#1-ì—°ë™-ê°€ì´ë“œ)
2. [API ë ˆí¼ëŸ°ìŠ¤](#2-api-ë ˆí¼ëŸ°ìŠ¤)
   - [í—¤ë” ì„¤ì •](#21-í—¤ë”-ì„¤ì •)
   - [ì…ê¸ˆ ìë™í™•ì¸ API](#22-ì…ê¸ˆ-ìë™í™•ì¸-api)
   - [ì…ì¶œê¸ˆ ë°ì´í„°ìˆ˜ì‹  API](#23-ì…ì¶œê¸ˆ-ë°ì´í„°ìˆ˜ì‹ -api)
   - [ì›¹í›…(Webhook)](#24-ì›¹í›…webhook)
3. [ìì£¼ë¬»ëŠ” ì§ˆë¬¸(FAQ)](#3-ìì£¼ë¬»ëŠ”-ì§ˆë¬¸faq)
4. [íŠ¸ëŸ¬ë¸”ìŠˆíŒ…](#4-íŠ¸ëŸ¬ë¸”ìŠˆíŒ…)

---

## 1. ì—°ë™ ê°€ì´ë“œ

PayActionì€ ë¬´í†µì¥ì…ê¸ˆ ê²°ì œê°€ í•„ìš”í•œ ëª¨ë“  ê³³ì— ì—°ë™í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì»¤ë¨¸ìŠ¤/ë±…í‚¹ SaaSì…ë‹ˆë‹¤.

### ì œê³µ ì„œë¹„ìŠ¤
- âœ… ì‹¤ì‹œê°„ ê²°ì œí™•ì¸ì„ ìœ„í•œ 1ì´ˆ ìë™ ì…ê¸ˆí™•ì¸
- âœ… ê²°ì œë‚´ì—­ í˜„ê¸ˆì˜ìˆ˜ì¦ ìë™ë°œí–‰/ì·¨ì†Œ
- âœ… ê³„ì¢Œ ì‹¤ì‹œê°„ ê±°ë˜ë°ì´í„° ìˆ˜ì‹ ì„ ìœ„í•œ 1ì´ˆ ì…ì¶œê¸ˆ ë°ì´í„° ìˆ˜ì‹ 

### ì—°ë™ ìˆœì„œ

#### (1) ìƒì ë“±ë¡
- [ì—°ë™ê´€ë¦¬] ë©”ë‰´ì—ì„œ ìƒì ì •ë³´ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.

#### (2) ê³„ì¢Œë“±ë¡  
- ê³„ì¢Œë“±ë¡ ë° í•´ë‹¹ì€í–‰ SMS í†µì§€ì„œë¹„ìŠ¤ ë“± ê°€ì´ë“œì— ë”°ë¼ ì‹ ì²­í•©ë‹ˆë‹¤.

#### (3) APIì •ë³´ ì…ë ¥
- [APIì„¤ì •] ë©”ë‰´ì—ì„œ APIí‚¤ë¥¼ ìƒì„±í•˜ê³  ì›¹í›…URLì„ ì…ë ¥í•©ë‹ˆë‹¤.

#### (4) ì„œë¹„ìŠ¤ ê°œë°œ ë° ì—°ë™
- ì•„ë˜ API ë ˆí¼ëŸ°ìŠ¤ë¥¼ ì°¸ê³ í•˜ì—¬ ì„œë¹„ìŠ¤ë¥¼ ê°œë°œ ë° ì—°ë™í•©ë‹ˆë‹¤.

---

## 2. API ë ˆí¼ëŸ°ìŠ¤

PayActionì˜ ëª¨ë“  APIëŠ” REST APIë¡œ ì œê³µë˜ë©°, HTTP ìš”ì²­ì„ ë³´ë‚¼ ìˆ˜ ìˆëŠ” í™˜ê²½ì´ë¼ë©´ OSë‚˜ DBì— ê´€ê³„ì—†ì´ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### íŠ¹ì§•
- ğŸ”’ ëª¨ë“  ë°ì´í„°ëŠ” ì €ì¥ ë° ì „ì†¡ì‹œ ì•”í˜¸í™”
- ğŸ›¡ï¸ SOC 2 Type II ë³´ì•ˆí‘œì¤€ ì¤€ìˆ˜
- â˜ï¸ Amazon AWS ìµœê³  ë³´ì•ˆìˆ˜ì¤€ ê´€ë¦¬
- ğŸ” SSL ë³´ì•ˆì´ ì ìš©ëœ HTTPS í”„ë¡œí† ì½œë§Œ ì§€ì›
- ğŸ“„ ìš”ì²­ ê²°ê³¼ëŠ” JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µ

### 2.1 í—¤ë” ì„¤ì •

ëª¨ë“  API ìš”ì²­ì‹œ ë°˜ë“œì‹œ í¬í•¨ë˜ì–´ì•¼ í•˜ëŠ” í—¤ë”:

| í—¤ë”ëª… | ê°’ | ì„¤ëª… |
|--------|-----|------|
| `Content-Type` | `application/json` | í•„ìˆ˜ |
| `x-api-key` | `your-api-key` | [ëŒ€ì‹œë³´ë“œ] > [APIì„¤ì •]ì˜ 'APIí‚¤'ì—ì„œ í™•ì¸ |
| `x-mall-id` | `your-mall-id` | [ëŒ€ì‹œë³´ë“œ] > [APIì„¤ì •]ì˜ 'ìƒì ID'ì—ì„œ í™•ì¸ |

### 2.2 ì…ê¸ˆ ìë™í™•ì¸ API

ì£¼ë¬¸ì„ ì œì¶œí•˜ê³ , ì…ê¸ˆ ë°œìƒì‹œ ë§¤ì¹­ë˜ëŠ” ê²½ìš° ì›¹í›…ìœ¼ë¡œ ë°›ì•„ ì²˜ë¦¬í•˜ëŠ” APIì…ë‹ˆë‹¤.

#### 2.2.1 ì£¼ë¬¸ API

**Endpoint**: `POST https://api.payaction.app/order`

**Request Body ì˜ˆì‹œ**:
```json
{
  "order_number": "1234567890",
  "order_amount": 19000,
  "order_date": "2023-07-26T11:31:00+09:00",
  "billing_name": "í™ê¸¸ë™",
  "orderer_name": "í™ê¸¸ë™",
  "orderer_phone_number": "01012345678",
  "orderer_email": "hong@gildong.kr",
  "trade_usage": "ì†Œë“ê³µì œìš©",
  "identity_number": "01012345678"
}
```

**Request Parameters**:

| í•„ë“œëª… | ì„¤ëª… | í•„ìˆ˜ | ë¹„ê³  |
|--------|------|------|------|
| `order_number` | ì£¼ë¬¸ë²ˆí˜¸ | **Yes** | 22ì ì´í•˜ ê¶Œì¥, ì´ˆê³¼ì‹œ ì•Œë¦¼í†¡ ë°œì†¡ë¶ˆê°€ |
| `order_amount` | ì£¼ë¬¸ê¸ˆì•¡ | **Yes** | ìˆ«ì |
| `order_date` | ì£¼ë¬¸ì¼ì‹œ | **Yes** | ISO 8601 Format (YYYY-MM-DDTHH:MM:SS+09:00) |
| `billing_name` | ì…ê¸ˆìëª… | **Yes** | âš ï¸ ìë™ë§¤ì¹­ì‹œ ë§¤ì¹­ì—¬ë¶€ íŒë‹¨ í•­ëª© |
| `orderer_name` | ì£¼ë¬¸ìëª… | **Yes** | - |
| `orderer_phone_number` | ì£¼ë¬¸ì ì „í™”ë²ˆí˜¸ | No | í•˜ì´í”ˆ(-) ì œì™¸, ì˜ˆ: 01012345678 |
| `orderer_email` | ì£¼ë¬¸ì ì´ë©”ì¼ | No | - |
| `trade_usage` | í˜„ê¸ˆì˜ìˆ˜ì¦ ê±°ë˜êµ¬ë¶„ | No | "ì†Œë“ê³µì œìš©" ë˜ëŠ” "ì§€ì¶œì¦ë¹™ìš©" |
| `identity_number` | í˜„ê¸ˆì˜ìˆ˜ì¦ ì‹ë³„ë²ˆí˜¸ | No | ìˆ«ìë§Œ ì…ë ¥ |

**ğŸ“Œ ì¤‘ìš” ì‚¬í•­**:
- `orderer_phone_number`ì™€ `orderer_email`ì€ ì•Œë¦¼ ë°œì†¡ì„ ì›í•˜ëŠ” ê²½ìš°ì—ë§Œ í¬í•¨
  - ì•Œë¦¼í†¡ ë°œì†¡: `orderer_phone_number` í•„ë“œ í¬í•¨
  - ì´ë©”ì¼ ë°œì†¡: `orderer_email` í•„ë“œ í¬í•¨
- í˜„ê¸ˆì˜ìˆ˜ì¦ ìë™ë°œí–‰ì€ í”„ë¦¬ë¯¸ì–´ í”Œëœ ì´ìƒì—ì„œ ì§€ì›

**Response ì˜ˆì‹œ**:

âœ… ì„±ê³µì‹œ:
```json
{
  "status": "success",
  "response": {}
}
```

âŒ ì‹¤íŒ¨ì‹œ:
```json
{
  "status": "error",
  "response": {
    "message": "ì´ë¯¸ í•´ë‹¹ ì£¼ë¬¸ë²ˆí˜¸ì˜ ì£¼ë¬¸ì´ ì¡´ì¬í•©ë‹ˆë‹¤."
  }
}
```

âš ï¸ **ê²½ê³ **: ìœ íš¨í•˜ì§€ ì•Šì€ API ìš”ì²­ì„ ì§€ì†ì ìœ¼ë¡œ ê³¼ë‹¤ì œì¶œí•˜ëŠ” ê²½ìš° ì„œë¹„ìŠ¤ ì´ìš©ì´ ì œí•œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### 2.2.2 ì£¼ë¬¸-ë§¤ì¹­ì œì™¸ API

**Endpoint**: `POST https://api.payaction.app/order-exclude`

ë§¤ì¹­ ëŒ€ìƒì—ì„œ ì œì™¸í•  ì£¼ë¬¸ê±´ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤.

#### 2.2.3 í˜„ê¸ˆì˜ìˆ˜ì¦-ë°œí–‰ì·¨ì†Œ API

**Endpoint**: `POST https://api.payaction.app/cashbill-cancel`

ë°œí–‰ëœ í˜„ê¸ˆì˜ìˆ˜ì¦ì„ ì·¨ì†Œí•©ë‹ˆë‹¤.

#### 2.2.4 ë§¤ì¹­ì™„ë£Œ ì›¹í›…

**Type**: `WEBHOOK`

ì…ê¸ˆê³¼ ì£¼ë¬¸ì´ ë§¤ì¹­ë˜ë©´ ë“±ë¡ëœ ì›¹í›… URLë¡œ ì „ì†¡ë©ë‹ˆë‹¤.

### 2.3 ì…ì¶œê¸ˆ ë°ì´í„°ìˆ˜ì‹  API

ì£¼ë¬¸ ì œì¶œ ì—†ì´ í•´ë‹¹ ê³„ì¢Œì˜ ì…ê¸ˆ ë° ì¶œê¸ˆ ë°œìƒì‹œ ì›¹í›…ìœ¼ë¡œ ë°›ì„ ìˆ˜ ìˆëŠ” APIì…ë‹ˆë‹¤.

**ìš©ë„**: PayActionì— ì£¼ë¬¸ ì…ë ¥ ì—†ì´ ì…ì¶œê¸ˆ ë‚´ì—­ ìˆ˜ì‹ ì´ í•„ìš”í•œ ê²½ìš°

**Type**: `WEBHOOK` - ì…ì¶œê¸ˆ ë°œìƒì‹œ ìë™ ì „ì†¡

### 2.4 ì›¹í›…(Webhook)

íŠ¹ì • ì´ë²¤íŠ¸ ë°œìƒì‹œ ê³ ê°ì‚¬ ì„œë²„ë¡œ ì´ë²¤íŠ¸ ì •ë³´ë¥¼ ìë™ì „ì†¡í•˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.

#### 2.4.1 ì¸ì¦ì •ë³´

ì›¹í›… ìˆ˜ì‹ ì‹œ í•¨ê»˜ ì „ì†¡ë˜ëŠ” í—¤ë” ì •ë³´:

| í—¤ë”ëª… | ì„¤ëª… |
|--------|------|
| `Content-Type` | `application/json` |
| `x-webhook-key` | ì›¹í›…í‚¤ (ëŒ€ì‹œë³´ë“œ > APIì„¤ì • > ì›¹í›…í‚¤ì—ì„œ í™•ì¸) |
| `x-mall-id` | ìƒì ID (ëŒ€ì‹œë³´ë“œ > APIì„¤ì • > ìƒì IDì—ì„œ í™•ì¸) |
| `x-trace-id` | íŠ¸ëœì­ì…˜ ê³ ìœ  ID |

âš ï¸ **ë³´ì•ˆ ì£¼ì˜**: ì›¹í›…í‚¤ëŠ” ë°œì‹ ìê°€ PayActionì„ì„ ê²€ì¦í•˜ëŠ” ì¤‘ìš”í•œ ì •ë³´ì´ë¯€ë¡œ, ì™¸ë¶€ ë…¸ì¶œì‹œ ì¦‰ì‹œ ì¬ë°œê¸‰ í•„ìš”

#### 2.4.2 í”„ë¡œì„¸ìŠ¤

1. **ì´ë²¤íŠ¸ ë°œìƒ**: ì´ë²¤íŠ¸ ë°œìƒ ì¦‰ì‹œ ë¯¸ë¦¬ ë“±ë¡í•œ ì›¹í›… URLë¡œ HTTP POST ìš”ì²­
2. **ì›¹í›… ìˆ˜ì‹  ë° ì‘ë‹µ ë°œì‹ **: ê³ ê°ì‚¬ëŠ” ìˆ˜ì‹ í•œ JSON ë°ì´í„°ë¥¼ ì‹œìŠ¤í…œì— ë°˜ì˜í•˜ê³  ì¦‰ì‹œ ì‘ë‹µ
3. **ì‘ë‹µ í™•ì¸**: PayActionì´ ì‘ë‹µì„ í™•ì¸í•˜ì—¬ ì„±ê³µ/ì‹¤íŒ¨ íŒë‹¨

#### 2.4.3 ì‘ë‹µê²°ê³¼ ë°˜í™˜

**ğŸ”´ ë§¤ìš° ì¤‘ìš”**: ì›¹í›…ì„ ì •ìƒì ìœ¼ë¡œ ìˆ˜ì‹ í•œ ê²½ìš° ë°˜ë“œì‹œ ì•„ë˜ì™€ ê°™ì´ ì‘ë‹µí•´ì•¼ í•©ë‹ˆë‹¤.

| ìœ í˜• | ìƒíƒœì½”ë“œ | ê²°ê³¼ê°’ |
|------|---------|--------|
| Response Body | **200** | `{"status": "success"}` |

```json
{
  "status": "success"
}
```

âš ï¸ ì •ìƒ ì‘ë‹µì„ ë°˜í™˜í•˜ì§€ ì•Šìœ¼ë©´:
- ì‹¤íŒ¨ë¡œ ê°„ì£¼ë˜ì–´ ì¬ì „ì†¡ë¨
- ì§€ì†ì ìœ¼ë¡œ ì‹¤íŒ¨ì‹œ ì›¹í›… ë°œì†¡ ì¤‘ë‹¨

#### 2.4.4 ì‹¤íŒ¨ ë° ì¬ì‹œë„

**ì£¼ìš” ì‹¤íŒ¨ ì‚¬ìœ **:
- ì‘ë‹µê²°ê³¼ ë¯¸ë°˜í™˜: ê³ ê°ì‚¬ ì„œë²„ê°€ ì›¹í›… ìˆ˜ì‹  í›„ ì‘ë‹µê²°ê³¼ë¥¼ ë°˜í™˜í•˜ì§€ ì•ŠëŠ” ê²½ìš°
- Response Body í˜•ì‹ ë¶ˆì¼ì¹˜: ìš”êµ¬í•œ í˜•ì‹ê³¼ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ê²½ìš°  
- HTTP í†µì‹  ì˜¤ë¥˜: ë„¤íŠ¸ì›Œí¬ ë¬¸ì œ, ì„œë²„ ë‹¤ìš´, ì—°ê²° ì˜¤ë¥˜ ë“±
- ê¸°íƒ€: ìœ„ì—ì„œ ì–¸ê¸‰ë˜ì§€ ì•Šì€ ì‹¤íŒ¨

ğŸ’¡ **íŒ**: ê³ ê°ì‚¬ ì‹œìŠ¤í…œ ì •ìƒí™” í›„ PayAction ì‚¬ì´íŠ¸ì—ì„œ ì›¹í›… ì¬ì „ì†¡ ìš”ì²­ ê°€ëŠ¥

#### 2.4.5 ì „ì†¡ë‚´ì—­ í™•ì¸

- **ê²½ë¡œ**: ëŒ€ì‹œë³´ë“œ > APIì„¤ì • > Webhookë¡œê·¸
- **ì¡°íšŒ ê¸°ê°„**: ìµœê·¼ 1ë‹¬ ì´ë‚´ ë°œì†¡ëœ ì›¹í›… ë‚´ì—­
- **ì¬ì „ì†¡**: [ì¬ì „ì†¡] ë²„íŠ¼ í´ë¦­ì‹œ í•´ë‹¹ ì›¹í›… ì¦‰ì‹œ ë°œì†¡
- **ìš©ë„**: 3íšŒ ì´ìƒ ì‹¤íŒ¨ë¡œ ì•Œë¦¼ ì´ë©”ì¼ ìˆ˜ì‹ í•œ ê²½ìš°, ì„œë²„ ì •ìƒí™” í›„ ì¬ìˆ˜ì‹ 

#### 2.4.6 ì¬ì „ì†¡ ì •ì±…

ì›¹í›… ëˆ„ë½ì´ë‚˜ ì§€ì—° ë°©ì§€ë¥¼ ìœ„í•´ **ìµœì´ˆ ì „ì†¡ í¬í•¨ ìµœëŒ€ 3íšŒ**ê¹Œì§€ ì¬ì „ì†¡í•©ë‹ˆë‹¤.

- 1ì°¨ ì‹œë„: ì¦‰ì‹œ
- 2ì°¨ ì‹œë„: ì‹¤íŒ¨ í›„ ì¼ì • ì‹œê°„ í›„
- 3ì°¨ ì‹œë„: ë§ˆì§€ë§‰ ì‹œë„
- **ìµœì¢… ì‹¤íŒ¨ì‹œ**: ì•Œë¦¼ ì´ë©”ì¼ ë°œì†¡

---

## 3. ìì£¼ë¬»ëŠ” ì§ˆë¬¸(FAQ)

### Q1. ìë™ë§¤ì¹­ë˜ëŠ” ê¸°ì¤€ì€ ë¬´ì—‡ì¸ê°€ìš”?

**ë‹µë³€**: 
- ì…ê¸ˆë‚´ì—­ì˜ **ì…ê¸ˆìëª…**ê³¼ **ì…ê¸ˆì•¡**ì´ ì£¼ë¬¸ì˜ **billing_name**ê³¼ **order_amount**ì™€ ì¼ì¹˜í•˜ëŠ” ì£¼ë¬¸ì´ **ì •í™•íˆ 1ê±´**ì¼ ë•Œ ìë™ë§¤ì¹­
- ì¼ì¹˜í•˜ëŠ” ì£¼ë¬¸ì´ ì—†ê±°ë‚˜ ë³µìˆ˜ê±´ì´ë©´ ë§¤ì¹­ë˜ì§€ ì•ŠìŒ
- ë§¤ì¹­ ì‹¤íŒ¨ì‹œ ì•Œë¦¼ ì´ë©”ì¼ ë°œì†¡

ğŸ’¡ **ìŠ¤ë§ˆíŠ¸ì˜¤ë”ë§¤ì¹­ ê¸°ëŠ¥**: 
- ëŒ€ì‹œë³´ë“œ > ì—°ë™ê´€ë¦¬ ë‚´ ê¸°ëŠ¥ì„¤ì •ì—ì„œ í™œì„±í™”
- ë§¤ì¹­ ëŒ€ìƒì´ ë³µìˆ˜ê±´ì´ì–´ë„ ë§¤ì¹­ ê°€ëŠ¥ (ê°€ì¥ ìµœê·¼ ë˜ëŠ” ê°€ì¥ ì˜¤ë˜ëœ ì£¼ë¬¸ìœ¼ë¡œ ë§¤ì¹­)

### Q2. ìˆ˜ë™ë§¤ì¹­ì‹œì—ë„ ì›¹í›…ìœ¼ë¡œ ì „ë‹¬ë˜ë‚˜ìš”?

**ë‹µë³€**: ë„¤, ì „ë‹¬ë©ë‹ˆë‹¤.

### Q3. ìë™ë§¤ì¹­ì´ ë˜ì§€ ì•Šì•˜ì–´ìš”.

**ê°œë°œì‹œ ì ê²€ì‚¬í•­**:

1. â° **ì£¼ë¬¸ íƒ€ì´ë°**
   - ì…ê¸ˆë‚´ì—­ ìˆ˜ì‹ ì‹œ ë§¤ì¹­ì´ ì§„í–‰ë˜ë¯€ë¡œ, ì£¼ë¬¸ì´ ì…ê¸ˆë³´ë‹¤ ë¨¼ì € ì „ë‹¬ë˜ì–´ì•¼ í•¨
   - ì£¼ë¬¸ ë°œìƒì‹œ ì¦‰ì‹œ [ì£¼ë¬¸] ì—”ë“œí¬ì¸íŠ¸ í˜¸ì¶œ
   - ì£¼ë¬¸ì¼ì‹œë¥¼ ë¯¸ë˜ì‹œê°„ìœ¼ë¡œ ì…ë ¥í•˜ì§€ ì•Šë„ë¡ ì£¼ì˜

2. ğŸ‘¤ **ì…ê¸ˆìëª… ì¼ì¹˜**
   - ì…ê¸ˆë‚´ì—­ì˜ ì…ê¸ˆìëª… = ì£¼ë¬¸ì˜ `billing_name` (âš ï¸ `orderer_name`ì´ ì•„ë‹˜!)

3. ğŸ”¤ **ê³µë°±ë¬¸ì ì²˜ë¦¬**
   - ì…ê¸ˆìëª… ì•ë’¤ ê³µë°±ë¬¸ì ì œê±° (Trim í™œìš©)

**ì¼ë°˜ì ì¸ ë§¤ì¹­ì‹¤íŒ¨ ì‚¬ìœ **:

| ì›ì¸ | í•´ê²°ë°©ë²• |
|------|---------|
| ë§¤ì¹­ëŒ€ìƒì´ ì—¬ëŸ¬ ê±´ | ìŠ¤ë§ˆíŠ¸ì˜¤ë”ë§¤ì¹­ ê¸°ëŠ¥ ì‚¬ìš© |
| ì£¼ë¬¸ í›„ 2ì£¼ì¼ ê²½ê³¼ | 2ì£¼ ì´ë‚´ ì£¼ë¬¸ë§Œ ë§¤ì¹­ ëŒ€ìƒ |
| ì£¼ë¬¸ì´ ì…ê¸ˆë³´ë‹¤ ëŠ¦ê²Œ ì „ë‹¬ | ì£¼ë¬¸ì„ ë¨¼ì € ì „ì†¡ |
| ì£¼ë¬¸ì¼ì‹œê°€ ì…ê¸ˆë³´ë‹¤ ë¯¸ë˜ | ì •í™•í•œ ì£¼ë¬¸ì¼ì‹œ ì…ë ¥ |
| ì…ê¸ˆìëª… ë¶ˆì¼ì¹˜ | `billing_name` í™•ì¸ |
| ê³µë°±ë¬¸ì í¬í•¨ | Trim ì²˜ë¦¬ |

### Q4. ì›¹í›…ì´ ì˜¤ì§€ ì•Šì•„ìš”.

**ì²´í¬ë¦¬ìŠ¤íŠ¸**:

âœ… APIì„¤ì • í˜ì´ì§€ì—ì„œ ë“±ë¡í•œ ì›¹í›… URLì´ ì •í™•í•œê°€ìš”?

âœ… í•´ë‹¹ URLì´ ì™¸ë¶€ ì¸í„°ë„·ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•œ ê³µê°œ ì£¼ì†Œì¸ê°€ìš”?
   - âŒ localhost ì£¼ì†ŒëŠ” ì‚¬ìš© ë¶ˆê°€

âœ… ë°©í™”ë²½ì´ë‚˜ í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ì—ì„œ ë¯¸êµ­ì„ ì°¨ë‹¨í•˜ê³  ìˆì§€ ì•Šë‚˜ìš”?
   - PayActionì€ AWS us-east-1 (ë¯¸êµ­ ë™ë¶€, ë²„ì§€ë‹ˆì•„ ë¶ë¶€) ë¦¬ì „ ì‚¬ìš©

âœ… ìœ íš¨í•œ SSL ì¸ì¦ì„œê°€ ì„¤ì¹˜ë˜ì–´ ìˆë‚˜ìš”?
   - ì¸ì¦ì„œ ë§Œë£Œ ì—¬ë¶€
   - ì¸ì¦ì„œ ì²´ì¸ ë¬¸ì œ

âœ… Postman ë“±ìœ¼ë¡œ ì›¹í›… URL í…ŒìŠ¤íŠ¸ì‹œ ì •ìƒ ì‘ë‹µí•˜ë‚˜ìš”?

### Q5. ì›¹í›… ìˆ˜ì‹  ì‹¤íŒ¨ ê´€ë ¨

ëª¨ë“  ì›¹í›… ì •ìƒ ìˆ˜ì‹ ì‹œ ë°˜ë“œì‹œ `{"status": "success"}` ì‘ë‹µì„ ë°˜í™˜í•´ì•¼ í•©ë‹ˆë‹¤.

- ì‘ë‹µ ë¯¸ë°˜í™˜ì‹œ â†’ ì‹¤íŒ¨ ì²˜ë¦¬ â†’ ì¬ì „ì†¡
- ìµœì¢… ì‹¤íŒ¨ì‹œ â†’ ì•Œë¦¼ ë°œì†¡
- ì¤‘ë³µ ìˆ˜ì‹  ë°©ì§€ë¥¼ ìœ„í•´ ì •í™•í•œ ì‘ë‹µ í•„ìˆ˜

---

## 4. íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ğŸ”´ "ëˆ„ë½ëœ í•„ë“œê°€ ì¡´ì¬í•©ë‹ˆë‹¤" ì—ëŸ¬

**ì›ì¸**: API ìš”ì²­ì‹œ í•„ìˆ˜ í•„ë“œ ëˆ„ë½ ë˜ëŠ” ì˜ëª»ëœ í•„ë“œëª… ì‚¬ìš©

**í•´ê²°**: 
```javascript
// âŒ ì˜ëª»ëœ í•„ë“œëª…
{
  "orderNo": "...",        // âŒ
  "amount": 10000,          // âŒ  
  "customer_name": "..."    // âŒ
}

// âœ… ì˜¬ë°”ë¥¸ í•„ë“œëª…
{
  "order_number": "...",    // âœ…
  "order_amount": 10000,    // âœ…
  "billing_name": "...",    // âœ…
  "orderer_name": "..."     // âœ…
}
```

### ğŸ”´ ì›¹í›… ìˆ˜ì‹  ì‹¤íŒ¨

**ì›ì¸ ë° í•´ê²°**:

1. **SSL ì¸ì¦ì„œ ë¬¸ì œ**
   - Let's Encrypt ë“± ìœ íš¨í•œ ì¸ì¦ì„œ ì„¤ì¹˜
   - ì¸ì¦ì„œ ì²´ì¸ ì™„ì„±ë„ í™•ì¸

2. **ë°©í™”ë²½ ì„¤ì •**
   - AWS Security Groupì—ì„œ ë¯¸êµ­ ë¦¬ì „ í—ˆìš©
   - Cloudflare ë“±ì—ì„œ êµ­ê°€ ì°¨ë‹¨ í•´ì œ

3. **ì‘ë‹µ í˜•ì‹ ì˜¤ë¥˜**
   ```javascript
   // âŒ ì˜ëª»ëœ ì‘ë‹µ
   res.send("OK");
   res.json({result: "success"});
   
   // âœ… ì˜¬ë°”ë¥¸ ì‘ë‹µ
   res.status(200).json({status: "success"});
   ```

### ğŸ”´ ìë™ë§¤ì¹­ ì‹¤íŒ¨

**ì²´í¬ í¬ì¸íŠ¸**:

1. **ì£¼ë¬¸ ì „ì†¡ ì‹œì **: ì…ê¸ˆ ì „ì— ì£¼ë¬¸ì´ PayActionì— ë“±ë¡ë˜ì—ˆëŠ”ì§€
2. **ì…ê¸ˆìëª… ì •í™•ì„±**: `billing_name`ê³¼ ì‹¤ì œ ì…ê¸ˆìëª… ì¼ì¹˜ ì—¬ë¶€
3. **ê¸ˆì•¡ ì¼ì¹˜**: `order_amount`ì™€ ì…ê¸ˆì•¡ ì •í™•íˆ ì¼ì¹˜
4. **ì£¼ë¬¸ ìœ íš¨ê¸°ê°„**: 2ì£¼ ì´ë‚´ ì£¼ë¬¸ì¸ì§€
5. **ì¤‘ë³µ ì£¼ë¬¸**: ë™ì¼ ê¸ˆì•¡/ì…ê¸ˆìëª… ì£¼ë¬¸ì´ ì—¬ëŸ¬ ê°œ ìˆëŠ”ì§€

---

## 5. êµ¬í˜„ ì˜ˆì‹œ ì½”ë“œ

### Node.js/Express ì›¹í›… ìˆ˜ì‹  ì˜ˆì‹œ

```javascript
app.post('/api/payaction-webhook', async (req, res) => {
  try {
    // 1. ì›¹í›… ì¸ì¦ ê²€ì¦
    const webhookKey = req.headers['x-webhook-key'];
    const mallId = req.headers['x-mall-id'];
    const traceId = req.headers['x-trace-id'];
    
    if (webhookKey !== process.env.PAYACTION_WEBHOOK_KEY) {
      return res.status(401).json({ error: 'Unauthorized' });
    }
    
    // 2. ì›¹í›… ë°ì´í„° ì²˜ë¦¬
    const webhookData = req.body;
    console.log('ì›¹í›… ìˆ˜ì‹ :', webhookData);
    
    // 3. ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì²˜ë¦¬
    // ì˜ˆ: ì£¼ë¬¸ ìƒíƒœ ì—…ë°ì´íŠ¸, ë¼ì´ì„¼ìŠ¤ ë°œê¸‰ ë“±
    await processPaymentConfirmation(webhookData);
    
    // 4. í•„ìˆ˜: ì„±ê³µ ì‘ë‹µ ë°˜í™˜
    return res.status(200).json({ status: "success" });
    
  } catch (error) {
    console.error('ì›¹í›… ì²˜ë¦¬ ì˜¤ë¥˜:', error);
    // ì—ëŸ¬ì‹œì—ë„ ì„±ê³µ ì‘ë‹µ ë°˜í™˜ (ì¬ì „ì†¡ ë°©ì§€)
    return res.status(200).json({ status: "success" });
  }
});
```

### ì£¼ë¬¸ ì œì¶œ ì˜ˆì‹œ

```javascript
async function submitOrder(orderData) {
  const response = await fetch('https://api.payaction.app/order', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'x-api-key': process.env.PAYACTION_API_KEY,
      'x-mall-id': process.env.PAYACTION_MALL_ID
    },
    body: JSON.stringify({
      order_number: orderData.orderId,
      order_amount: orderData.amount,
      order_date: new Date().toISOString().replace('Z', '+09:00'),
      billing_name: orderData.depositName || orderData.customerName,
      orderer_name: orderData.customerName,
      orderer_phone_number: orderData.phone.replace(/-/g, ''),
      orderer_email: orderData.email
    })
  });
  
  const result = await response.json();
  
  if (result.status !== 'success') {
    throw new Error(`PayAction API ì˜¤ë¥˜: ${result.response?.message}`);
  }
  
  return result;
}
```

---

## ğŸ“Œ í•µì‹¬ ìš”ì•½

1. **í•„ìˆ˜ í—¤ë”**: `x-api-key`, `x-mall-id` 
2. **ì˜¬ë°”ë¥¸ í•„ë“œëª…**: `order_number`, `order_amount`, `billing_name` ë“±
3. **ì›¹í›… ì‘ë‹µ**: ë°˜ë“œì‹œ `{"status": "success"}` with HTTP 200
4. **ìë™ë§¤ì¹­ ì¡°ê±´**: ì…ê¸ˆìëª… + ê¸ˆì•¡ = 1ê°œ ì£¼ë¬¸
5. **ì¬ì „ì†¡ ì •ì±…**: ìµœëŒ€ 3íšŒ ì‹œë„
6. **ì£¼ë¬¸ íƒ€ì´ë°**: ì…ê¸ˆ ì „ì— ì£¼ë¬¸ ë¨¼ì € ì „ì†¡
7. **SSL í•„ìˆ˜**: ìœ íš¨í•œ ì¸ì¦ì„œ ì„¤ì¹˜
8. **ë¯¸êµ­ ë¦¬ì „ í—ˆìš©**: AWS us-east-1 ì ‘ê·¼ í—ˆìš©

---

*ì´ ë¬¸ì„œëŠ” PayAction ê°œë°œì ì„¼í„°ì˜ ê³µì‹ ë¬¸ì„œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.*
*ìµœì¢… ì—…ë°ì´íŠ¸: 2024ë…„*